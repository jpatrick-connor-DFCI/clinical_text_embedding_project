  0%|          | 0/7 [00:00<?, ?it/s]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 14%|█▍        | 1/7 [00:40<04:02, 40.38s/it] 29%|██▊       | 2/7 [00:52<02:00, 24.02s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 43%|████▎     | 3/7 [01:01<01:08, 17.12s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 57%|█████▋    | 4/7 [01:20<00:53, 17.79s/it] 71%|███████▏  | 5/7 [01:37<00:34, 17.47s/it] 86%|████████▌ | 6/7 [01:53<00:16, 16.98s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
100%|██████████| 7/7 [02:15<00:00, 18.49s/it]100%|██████████| 7/7 [02:15<00:00, 19.31s/it]
  0%|          | 0/338 [00:00<?, ?it/s]  0%|          | 1/338 [00:18<1:41:08, 18.01s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  1%|          | 2/338 [00:29<1:20:10, 14.32s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
  1%|          | 3/338 [00:39<1:07:27, 12.08s/it]  1%|          | 4/338 [00:54<1:13:49, 13.26s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  1%|▏         | 5/338 [01:12<1:23:33, 15.06s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  2%|▏         | 6/338 [01:35<1:38:46, 17.85s/it]  2%|▏         | 7/338 [01:44<1:22:20, 14.93s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  2%|▏         | 8/338 [02:15<1:49:26, 19.90s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  3%|▎         | 9/338 [02:27<1:36:43, 17.64s/it]  3%|▎         | 10/338 [02:46<1:38:47, 18.07s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  3%|▎         | 11/338 [02:58<1:27:03, 15.98s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  4%|▎         | 12/338 [03:09<1:19:00, 14.54s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  4%|▍         | 13/338 [03:27<1:23:50, 15.48s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  4%|▍         | 14/338 [03:36<1:13:26, 13.60s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  4%|▍         | 15/338 [03:49<1:13:02, 13.57s/it]  5%|▍         | 16/338 [04:05<1:16:20, 14.22s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
  5%|▌         | 17/338 [04:15<1:08:38, 12.83s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  5%|▌         | 18/338 [04:26<1:05:21, 12.26s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  6%|▌         | 19/338 [04:39<1:07:26, 12.69s/it]  6%|▌         | 20/338 [04:48<1:00:44, 11.46s/it]  6%|▌         | 21/338 [05:07<1:12:28, 13.72s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  7%|▋         | 22/338 [05:21<1:12:53, 13.84s/it]  7%|▋         | 23/338 [05:30<1:05:37, 12.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  7%|▋         | 24/338 [05:40<1:00:28, 11.56s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  7%|▋         | 25/338 [05:49<57:30, 11.02s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  8%|▊         | 26/338 [06:30<1:42:40, 19.75s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  8%|▊         | 27/338 [06:49<1:42:11, 19.71s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  8%|▊         | 28/338 [07:00<1:28:14, 17.08s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  9%|▊         | 29/338 [07:10<1:16:41, 14.89s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  9%|▉         | 30/338 [08:20<2:41:41, 31.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  9%|▉         | 31/338 [08:49<2:37:10, 30.72s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
  9%|▉         | 32/338 [09:03<2:11:12, 25.73s/it] 10%|▉         | 33/338 [09:12<1:44:44, 20.61s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 10%|█         | 34/338 [09:39<1:54:12, 22.54s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 10%|█         | 35/338 [09:53<1:41:25, 20.08s/it] 11%|█         | 36/338 [10:02<1:24:11, 16.73s/it] 11%|█         | 37/338 [10:12<1:13:07, 14.58s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 11%|█         | 38/338 [10:29<1:16:27, 15.29s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 12%|█▏        | 39/338 [10:43<1:15:28, 15.15s/it] 12%|█▏        | 40/338 [10:53<1:06:19, 13.36s/it] 12%|█▏        | 41/338 [11:02<59:51, 12.09s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 12%|█▏        | 42/338 [11:19<1:07:12, 13.62s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 13%|█▎        | 43/338 [11:38<1:15:30, 15.36s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 13%|█▎        | 44/338 [11:49<1:09:00, 14.08s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 13%|█▎        | 45/338 [12:01<1:04:49, 13.27s/it] 14%|█▎        | 46/338 [12:10<59:09, 12.16s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 14%|█▍        | 47/338 [12:42<1:26:42, 17.88s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 14%|█▍        | 48/338 [12:55<1:20:06, 16.58s/it] 14%|█▍        | 49/338 [13:04<1:08:56, 14.31s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 15%|█▍        | 50/338 [13:18<1:07:45, 14.12s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 15%|█▌        | 51/338 [13:27<1:00:27, 12.64s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 15%|█▌        | 52/338 [13:37<56:00, 11.75s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 16%|█▌        | 53/338 [13:48<55:13, 11.63s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 16%|█▌        | 54/338 [14:00<55:27, 11.72s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 16%|█▋        | 55/338 [14:11<53:42, 11.39s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 17%|█▋        | 56/338 [14:21<52:06, 11.09s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 17%|█▋        | 57/338 [14:34<55:06, 11.77s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 17%|█▋        | 58/338 [14:58<1:11:39, 15.36s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 17%|█▋        | 59/338 [15:12<1:09:38, 14.98s/it] 18%|█▊        | 60/338 [15:25<1:06:49, 14.42s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 18%|█▊        | 61/338 [15:35<1:00:36, 13.13s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 18%|█▊        | 62/338 [15:45<55:14, 12.01s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 19%|█▊        | 63/338 [15:55<52:08, 11.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 19%|█▉        | 64/338 [16:06<51:14, 11.22s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 19%|█▉        | 65/338 [16:17<51:41, 11.36s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 20%|█▉        | 66/338 [16:40<1:06:21, 14.64s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 20%|█▉        | 67/338 [16:55<1:07:45, 15.00s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 20%|██        | 68/338 [17:39<1:46:08, 23.59s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 20%|██        | 69/338 [17:57<1:38:40, 22.01s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 21%|██        | 70/338 [18:22<1:42:10, 22.88s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 21%|██        | 71/338 [18:39<1:33:54, 21.10s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 21%|██▏       | 72/338 [18:52<1:22:57, 18.71s/it] 22%|██▏       | 73/338 [19:01<1:08:52, 15.60s/it] 22%|██▏       | 74/338 [19:13<1:04:11, 14.59s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 22%|██▏       | 75/338 [19:55<1:40:39, 22.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 22%|██▏       | 76/338 [20:22<1:44:30, 23.93s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 23%|██▎       | 77/338 [20:39<1:36:08, 22.10s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 23%|██▎       | 78/338 [20:58<1:31:29, 21.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 23%|██▎       | 79/338 [21:08<1:16:15, 17.67s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 24%|██▎       | 80/338 [21:30<1:21:12, 18.89s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 24%|██▍       | 81/338 [22:22<2:03:53, 28.92s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 24%|██▍       | 82/338 [22:34<1:42:23, 24.00s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 25%|██▍       | 83/338 [22:47<1:28:03, 20.72s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 25%|██▍       | 84/338 [22:57<1:13:31, 17.37s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 25%|██▌       | 85/338 [23:13<1:11:08, 16.87s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 25%|██▌       | 86/338 [23:28<1:09:25, 16.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 26%|██▌       | 87/338 [23:40<1:02:36, 14.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 26%|██▌       | 88/338 [23:52<58:26, 14.03s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 26%|██▋       | 89/338 [24:02<53:25, 12.87s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 27%|██▋       | 90/338 [24:11<48:50, 11.82s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 27%|██▋       | 91/338 [24:21<45:37, 11.08s/it] 27%|██▋       | 92/338 [24:30<42:53, 10.46s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 28%|██▊       | 93/338 [24:40<42:43, 10.46s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 28%|██▊       | 94/338 [24:57<50:33, 12.43s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 28%|██▊       | 95/338 [25:09<50:13, 12.40s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 28%|██▊       | 96/338 [25:22<50:34, 12.54s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 29%|██▊       | 97/338 [25:43<1:00:37, 15.09s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 29%|██▉       | 98/338 [26:31<1:39:08, 24.78s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 29%|██▉       | 99/338 [26:44<1:25:06, 21.37s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 30%|██▉       | 100/338 [26:57<1:14:51, 18.87s/it] 30%|██▉       | 101/338 [27:17<1:15:54, 19.22s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 30%|███       | 102/338 [28:00<1:43:55, 26.42s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 30%|███       | 103/338 [28:24<1:39:52, 25.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 31%|███       | 104/338 [28:33<1:21:01, 20.77s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 31%|███       | 105/338 [28:45<1:10:08, 18.06s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 31%|███▏      | 106/338 [29:02<1:08:07, 17.62s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 32%|███▏      | 107/338 [29:30<1:19:57, 20.77s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 32%|███▏      | 108/338 [30:01<1:31:52, 23.97s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 32%|███▏      | 109/338 [30:18<1:22:50, 21.70s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 33%|███▎      | 110/338 [30:30<1:11:36, 18.84s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 33%|███▎      | 111/338 [30:57<1:21:06, 21.44s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 33%|███▎      | 112/338 [31:14<1:15:07, 19.94s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 33%|███▎      | 113/338 [32:06<1:50:43, 29.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 34%|███▎      | 114/338 [32:39<1:54:24, 30.65s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 34%|███▍      | 115/338 [33:05<1:49:09, 29.37s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 34%|███▍      | 116/338 [33:15<1:26:56, 23.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 35%|███▍      | 117/338 [33:27<1:13:30, 19.95s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 35%|███▍      | 118/338 [34:07<1:35:37, 26.08s/it] 35%|███▌      | 119/338 [34:24<1:25:23, 23.40s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 36%|███▌      | 120/338 [35:20<1:59:49, 32.98s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 36%|███▌      | 121/338 [35:44<1:49:41, 30.33s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
 36%|███▌      | 122/338 [36:27<2:02:45, 34.10s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 36%|███▋      | 123/338 [36:45<1:44:56, 29.29s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 37%|███▋      | 124/338 [37:01<1:30:12, 25.29s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 37%|███▋      | 125/338 [37:40<1:44:32, 29.45s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 37%|███▋      | 126/338 [38:00<1:33:39, 26.51s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 38%|███▊      | 127/338 [38:12<1:17:58, 22.17s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 38%|███▊      | 128/338 [38:38<1:22:02, 23.44s/it] 38%|███▊      | 129/338 [38:48<1:08:02, 19.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 38%|███▊      | 130/338 [40:41<2:44:15, 47.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
 39%|███▉      | 131/338 [41:41<2:56:47, 51.24s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 39%|███▉      | 132/338 [42:18<2:40:48, 46.84s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 39%|███▉      | 133/338 [42:36<2:10:52, 38.31s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 40%|███▉      | 134/338 [43:12<2:07:51, 37.60s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 40%|███▉      | 135/338 [43:32<1:49:11, 32.28s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 40%|████      | 136/338 [45:50<3:35:50, 64.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 41%|████      | 137/338 [46:36<3:16:30, 58.66s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 41%|████      | 138/338 [46:48<2:28:18, 44.49s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 41%|████      | 139/338 [47:01<1:56:14, 35.05s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 41%|████▏     | 140/338 [47:16<1:36:38, 29.29s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 42%|████▏     | 141/338 [47:29<1:19:34, 24.24s/it] 42%|████▏     | 142/338 [47:39<1:05:23, 20.02s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 42%|████▏     | 143/338 [47:49<55:24, 17.05s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 43%|████▎     | 144/338 [48:27<1:15:02, 23.21s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 43%|████▎     | 145/338 [48:51<1:15:08, 23.36s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 43%|████▎     | 146/338 [49:09<1:09:54, 21.85s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 43%|████▎     | 147/338 [49:20<59:30, 18.69s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 44%|████▍     | 148/338 [49:46<1:05:30, 20.68s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 44%|████▍     | 149/338 [49:59<58:43, 18.64s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 44%|████▍     | 150/338 [50:16<56:48, 18.13s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 45%|████▍     | 151/338 [50:27<49:42, 15.95s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 45%|████▍     | 152/338 [50:37<43:56, 14.17s/it] 45%|████▌     | 153/338 [50:46<38:43, 12.56s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 46%|████▌     | 154/338 [50:59<38:54, 12.69s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 46%|████▌     | 155/338 [52:03<1:25:24, 28.00s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 46%|████▌     | 156/338 [52:52<1:43:57, 34.27s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 46%|████▋     | 157/338 [53:02<1:21:34, 27.04s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 47%|████▋     | 158/338 [53:12<1:06:00, 22.00s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 47%|████▋     | 159/338 [53:37<1:08:00, 22.79s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 47%|████▋     | 160/338 [54:04<1:11:31, 24.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 48%|████▊     | 161/338 [54:27<1:10:12, 23.80s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 48%|████▊     | 162/338 [54:38<58:31, 19.95s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 48%|████▊     | 163/338 [54:53<53:54, 18.48s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 49%|████▊     | 164/338 [55:06<49:10, 16.96s/it] 49%|████▉     | 165/338 [55:16<42:21, 14.69s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 49%|████▉     | 166/338 [55:36<46:44, 16.31s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 49%|████▉     | 167/338 [55:48<43:14, 15.17s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 50%|████▉     | 168/338 [56:03<42:26, 14.98s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
 50%|█████     | 169/338 [56:49<1:08:06, 24.18s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 50%|█████     | 170/338 [57:05<1:00:47, 21.71s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 51%|█████     | 171/338 [57:15<50:55, 18.30s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 51%|█████     | 172/338 [57:32<49:57, 18.06s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 51%|█████     | 173/338 [57:52<51:07, 18.59s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 51%|█████▏    | 174/338 [58:04<45:31, 16.65s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 52%|█████▏    | 175/338 [58:28<51:08, 18.83s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 52%|█████▏    | 176/338 [59:01<1:02:01, 22.97s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 52%|█████▏    | 177/338 [59:12<52:25, 19.54s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 53%|█████▎    | 178/338 [59:31<51:26, 19.29s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 53%|█████▎    | 179/338 [59:54<54:19, 20.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 53%|█████▎    | 180/338 [1:00:06<46:52, 17.80s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 54%|█████▎    | 181/338 [1:00:24<46:49, 17.89s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 54%|█████▍    | 182/338 [1:00:41<45:47, 17.61s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
 54%|█████▍    | 183/338 [1:01:21<1:03:13, 24.47s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 54%|█████▍    | 184/338 [1:01:35<54:27, 21.21s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 55%|█████▍    | 185/338 [1:01:58<55:43, 21.85s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 55%|█████▌    | 186/338 [1:02:18<54:00, 21.32s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 55%|█████▌    | 187/338 [1:02:33<48:50, 19.40s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 56%|█████▌    | 188/338 [1:03:00<53:34, 21.43s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 56%|█████▌    | 189/338 [1:03:31<1:00:49, 24.49s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 56%|█████▌    | 190/338 [1:04:28<1:24:01, 34.07s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 57%|█████▋    | 191/338 [1:04:42<1:08:58, 28.15s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 57%|█████▋    | 192/338 [1:04:55<57:41, 23.71s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 57%|█████▋    | 193/338 [1:05:21<58:40, 24.28s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 57%|█████▋    | 194/338 [1:05:38<53:07, 22.13s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 58%|█████▊    | 195/338 [1:06:17<1:04:41, 27.15s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 58%|█████▊    | 196/338 [1:06:37<59:30, 25.14s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 58%|█████▊    | 197/338 [1:06:54<53:19, 22.69s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 59%|█████▊    | 198/338 [1:07:09<47:10, 20.22s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 59%|█████▉    | 199/338 [1:07:27<45:44, 19.74s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 59%|█████▉    | 200/338 [1:07:42<41:48, 18.17s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 59%|█████▉    | 201/338 [1:08:04<44:20, 19.42s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 60%|█████▉    | 202/338 [1:08:19<40:42, 17.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 60%|██████    | 203/338 [1:08:42<43:50, 19.49s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 60%|██████    | 204/338 [1:09:05<45:45, 20.49s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 61%|██████    | 205/338 [1:09:46<59:19, 26.76s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 61%|██████    | 206/338 [1:10:03<52:30, 23.87s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 61%|██████    | 207/338 [1:10:13<42:38, 19.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 62%|██████▏   | 208/338 [1:10:25<37:42, 17.40s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 62%|██████▏   | 209/338 [1:10:42<37:02, 17.23s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 62%|██████▏   | 210/338 [1:11:41<1:03:53, 29.95s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 62%|██████▏   | 211/338 [1:11:53<51:56, 24.54s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 63%|██████▎   | 212/338 [1:12:27<57:14, 27.26s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
 63%|██████▎   | 213/338 [1:13:08<1:05:14, 31.32s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 63%|██████▎   | 214/338 [1:13:21<53:32, 25.91s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 64%|██████▎   | 215/338 [1:13:42<49:52, 24.33s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 64%|██████▍   | 216/338 [1:14:00<45:37, 22.44s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 64%|██████▍   | 217/338 [1:14:26<47:51, 23.73s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 64%|██████▍   | 218/338 [1:14:45<44:14, 22.12s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 65%|██████▍   | 219/338 [1:14:57<37:46, 19.05s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 65%|██████▌   | 220/338 [1:16:07<1:07:54, 34.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 65%|██████▌   | 221/338 [1:16:29<1:00:01, 30.78s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 66%|██████▌   | 222/338 [1:16:43<49:37, 25.67s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 66%|██████▌   | 223/338 [1:17:07<48:15, 25.18s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 66%|██████▋   | 224/338 [1:17:32<47:31, 25.01s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
 67%|██████▋   | 225/338 [1:18:15<57:38, 30.60s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 67%|██████▋   | 226/338 [1:18:31<48:55, 26.21s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 67%|██████▋   | 227/338 [1:18:47<42:34, 23.02s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 67%|██████▋   | 228/338 [1:19:04<38:48, 21.17s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 68%|██████▊   | 229/338 [1:19:24<38:04, 20.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 68%|██████▊   | 230/338 [1:19:37<33:20, 18.52s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 68%|██████▊   | 231/338 [1:19:56<33:18, 18.68s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 69%|██████▊   | 232/338 [1:20:17<34:11, 19.35s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 69%|██████▉   | 233/338 [1:20:35<32:58, 18.84s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 69%|██████▉   | 234/338 [1:21:12<42:03, 24.26s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 70%|██████▉   | 235/338 [1:21:55<51:41, 30.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 70%|██████▉   | 236/338 [1:22:10<43:21, 25.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 70%|███████   | 237/338 [1:22:28<39:17, 23.34s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 70%|███████   | 238/338 [1:22:55<40:14, 24.14s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 71%|███████   | 239/338 [1:23:33<46:51, 28.39s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 71%|███████   | 240/338 [1:23:43<37:25, 22.91s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 71%|███████▏  | 241/338 [1:23:53<30:38, 18.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 72%|███████▏  | 242/338 [1:24:05<27:20, 17.09s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 72%|███████▏  | 243/338 [1:24:32<31:41, 20.01s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 72%|███████▏  | 244/338 [1:24:43<26:53, 17.17s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 72%|███████▏  | 245/338 [1:25:01<27:11, 17.54s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 73%|███████▎  | 246/338 [1:25:52<42:10, 27.51s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 73%|███████▎  | 247/338 [1:26:19<41:19, 27.25s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 73%|███████▎  | 248/338 [1:26:31<34:04, 22.72s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 74%|███████▎  | 249/338 [1:26:46<30:10, 20.35s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 74%|███████▍  | 250/338 [1:27:17<34:41, 23.65s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 74%|███████▍  | 251/338 [1:28:05<44:54, 30.97s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 75%|███████▍  | 252/338 [1:28:23<39:02, 27.24s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 75%|███████▍  | 253/338 [1:28:38<33:18, 23.51s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 75%|███████▌  | 254/338 [1:29:05<34:07, 24.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 75%|███████▌  | 255/338 [1:29:22<30:45, 22.23s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 76%|███████▌  | 256/338 [1:29:39<28:28, 20.83s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 76%|███████▌  | 257/338 [1:30:05<30:09, 22.34s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 76%|███████▋  | 258/338 [1:30:20<26:54, 20.18s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 77%|███████▋  | 259/338 [1:30:36<24:52, 18.89s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 77%|███████▋  | 260/338 [1:31:01<26:38, 20.49s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 77%|███████▋  | 261/338 [1:31:19<25:36, 19.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 78%|███████▊  | 262/338 [1:31:36<24:13, 19.12s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 78%|███████▊  | 263/338 [1:31:58<24:50, 19.88s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 78%|███████▊  | 264/338 [1:32:21<25:36, 20.76s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 78%|███████▊  | 265/338 [1:32:35<22:47, 18.73s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 79%|███████▊  | 266/338 [1:34:49<1:03:53, 53.24s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 79%|███████▉  | 267/338 [1:35:27<57:33, 48.64s/it]  /data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 79%|███████▉  | 268/338 [1:35:45<46:06, 39.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 80%|███████▉  | 269/338 [1:36:28<46:42, 40.62s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 80%|███████▉  | 270/338 [1:36:45<37:49, 33.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 80%|████████  | 271/338 [1:37:13<35:47, 32.05s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 80%|████████  | 272/338 [1:37:23<27:55, 25.39s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 81%|████████  | 273/338 [1:38:10<34:27, 31.81s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 81%|████████  | 274/338 [1:38:26<28:59, 27.18s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 81%|████████▏ | 275/338 [1:38:55<29:06, 27.73s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 82%|████████▏ | 276/338 [1:39:11<24:57, 24.15s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 82%|████████▏ | 277/338 [1:39:41<26:11, 25.77s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 82%|████████▏ | 278/338 [1:40:34<33:56, 33.94s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: divide by zero encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 83%|████████▎ | 279/338 [1:41:11<34:13, 34.81s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 83%|████████▎ | 280/338 [1:41:53<35:52, 37.12s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 83%|████████▎ | 281/338 [1:42:33<36:01, 37.92s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 83%|████████▎ | 282/338 [1:42:43<27:33, 29.53s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 84%|████████▎ | 283/338 [1:42:58<23:08, 25.25s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 84%|████████▍ | 284/338 [1:43:09<18:57, 21.06s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 84%|████████▍ | 285/338 [1:43:23<16:29, 18.66s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 85%|████████▍ | 286/338 [1:43:35<14:31, 16.75s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 85%|████████▍ | 287/338 [1:44:14<19:53, 23.40s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/numpy/_core/fromnumeric.py:86: RuntimeWarning: overflow encountered in reduce
  return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
 85%|████████▌ | 288/338 [1:44:32<18:08, 21.76s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 86%|████████▌ | 289/338 [1:44:49<16:44, 20.50s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 86%|████████▌ | 290/338 [1:45:00<14:08, 17.68s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 86%|████████▌ | 291/338 [1:45:42<19:35, 25.01s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 86%|████████▋ | 292/338 [1:46:06<18:43, 24.43s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 87%|████████▋ | 293/338 [1:46:23<16:41, 22.25s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 87%|████████▋ | 294/338 [1:46:41<15:21, 20.95s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 87%|████████▋ | 295/338 [1:47:25<19:57, 27.86s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 88%|████████▊ | 296/338 [1:49:43<42:44, 61.06s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 88%|████████▊ | 297/338 [1:50:04<33:27, 48.96s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 88%|████████▊ | 298/338 [1:51:01<34:20, 51.52s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 88%|████████▊ | 299/338 [1:51:19<26:47, 41.23s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 89%|████████▉ | 300/338 [1:51:38<21:56, 34.65s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 89%|████████▉ | 301/338 [1:51:58<18:44, 30.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 89%|████████▉ | 302/338 [1:52:13<15:26, 25.73s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 90%|████████▉ | 303/338 [1:52:30<13:31, 23.20s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 90%|████████▉ | 304/338 [1:52:44<11:29, 20.27s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 90%|█████████ | 305/338 [1:52:58<10:06, 18.37s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 91%|█████████ | 306/338 [1:53:31<12:08, 22.78s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 91%|█████████ | 307/338 [1:53:52<11:27, 22.19s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 91%|█████████ | 308/338 [1:54:07<10:04, 20.17s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 91%|█████████▏| 309/338 [1:54:19<08:36, 17.82s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 92%|█████████▏| 310/338 [1:54:37<08:15, 17.70s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 92%|█████████▏| 311/338 [1:55:05<09:23, 20.87s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 92%|█████████▏| 312/338 [1:56:10<14:49, 34.21s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 93%|█████████▎| 313/338 [1:57:02<16:24, 39.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 93%|█████████▎| 314/338 [1:57:19<13:01, 32.56s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 93%|█████████▎| 315/338 [1:57:48<12:04, 31.51s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 93%|█████████▎| 316/338 [1:58:46<14:31, 39.63s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 94%|█████████▍| 317/338 [1:59:02<11:23, 32.57s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 94%|█████████▍| 318/338 [2:00:34<16:45, 50.26s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 94%|█████████▍| 319/338 [2:01:07<14:17, 45.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 95%|█████████▍| 320/338 [2:01:24<10:58, 36.61s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 95%|█████████▍| 321/338 [2:02:15<11:39, 41.12s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 95%|█████████▌| 322/338 [2:02:52<10:37, 39.87s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 96%|█████████▌| 323/338 [2:03:43<10:45, 43.02s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 96%|█████████▌| 324/338 [2:04:07<08:42, 37.35s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 96%|█████████▌| 325/338 [2:05:33<11:17, 52.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 96%|█████████▋| 326/338 [2:06:05<09:10, 45.89s/it] 97%|█████████▋| 327/338 [2:06:16<06:31, 35.58s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 97%|█████████▋| 328/338 [2:07:16<07:07, 42.73s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 97%|█████████▋| 329/338 [2:07:58<06:22, 42.47s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 98%|█████████▊| 330/338 [2:08:10<04:26, 33.33s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:81: RuntimeWarning: invalid value encountered in divide
  y = np.cumsum(n_events / divisor)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 98%|█████████▊| 331/338 [2:08:48<04:04, 34.90s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:64: RuntimeWarning: overflow encountered in exp
  risk_score = np.exp(linear_predictor)
/data/gusev/USERS/jpconnor/conda/envs/clinical_notes_project/lib/python3.13/site-packages/sksurv/linear_model/coxph.py:75: RuntimeWarning: invalid value encountered in scalar subtract
  value -= risk_score[k : (k + d)].sum()
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 98%|█████████▊| 332/338 [2:09:17<03:18, 33.08s/it] 99%|█████████▊| 333/338 [2:09:40<02:30, 30.11s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 99%|█████████▉| 334/338 [2:09:53<01:39, 24.85s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 99%|█████████▉| 335/338 [2:10:20<01:17, 25.68s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
 99%|█████████▉| 336/338 [2:10:44<00:50, 25.05s/it]100%|█████████▉| 337/338 [2:10:57<00:21, 21.38s/it]/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
/data/gusev/USERS/jpconnor/clinical_text_project/code/python_utils/embed_surv_utils/cox_models.py:746: ConvergenceWarning: Optimization terminated early, you might want to increase the number of iterations (max_iter=1000).
  model.fit(X_tr, y_tr)
100%|██████████| 338/338 [2:11:29<00:00, 24.61s/it]100%|██████████| 338/338 [2:11:29<00:00, 23.34s/it]
